<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7è¯­è¨€å­¦ä¹ è¯¾ç¨‹ - å®Œæ•´ç‰ˆ (70,000è¯æ±‡)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'SimHei', Arial, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin: 20px 0;
            text-align: center;
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
        }
        
        .stat-number {
            font-size: 1.8em;
            font-weight: bold;
            color: #fff;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .schedule {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: #e0e0e0;
            margin: 20px 0;
        }
        
        .day-card {
            background: white;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .day-card:hover {
            background: #f5f5f5;
            transform: translateY(-2px);
        }
        
        .day-card.today {
            background: #4CAF50;
            color: white;
        }
        
        .day-card.checked-in {
            background: #2196F3;
            color: white;
        }
        
        .day-card.active {
            background: #ff9800;
            color: white;
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.2em;
            color: #666;
        }
        
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .controls {
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #0056b3;
        }
        
        .btn.success {
            background: #28a745;
        }
        
        .btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        
        .search-box {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            width: 200px;
        }
        
        .pagination {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .page-input {
            width: 80px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
            text-align: center;
        }
        
        .language-content {
            padding: 30px;
            display: none;
        }
        
        .language-content.active {
            display: block;
        }
        
        .vocabulary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .word-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .word-card:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .word-card.learned {
            background: #d4edda;
            border-color: #c3e6cb;
        }
        
        .word-original {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }
        
        .word-translation {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 10px;
        }
        
        .word-pronunciation {
            font-size: 0.9em;
            color: #888;
            font-style: italic;
            margin-bottom: 15px;
        }
        
        .word-actions {
            display: flex;
            gap: 10px;
            justify-content: space-between;
            align-items: center;
        }
        
        .learn-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        
        .pronunciation-btn {
            padding: 8px 15px;
            background: #17a2b8;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
        }
        
        .pronunciation-btn:hover {
            background: #138496;
        }
        
        .progress-info {
            background: #d1ecf1;
            color: #0c5460;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸŒ 7è¯­è¨€å­¦ä¹ è¯¾ç¨‹</h1>
            <p>æ¯æ—¥å­¦ä¹ è¿½è¸ªå™¨ - å®Œæ•´ç‰ˆ (70,000è¯æ±‡)</p>
            
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-number" id="totalWords">70,000</div>
                    <div class="stat-label">æ€»è¯æ±‡</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="learnedWords">0</div>
                    <div class="stat-label">å·²å­¦è¯æ±‡</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="currentPage">1</div>
                    <div class="stat-label">å½“å‰é¡µé¢</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="totalPages">500</div>
                    <div class="stat-label">æ€»é¡µæ•°</div>
                </div>
            </div>
            
            <div class="schedule">
                <div class="day-card" data-day="monday" data-language="korean">
                    <div>å‘¨ä¸€</div>
                    <div><strong>í•œêµ­ì–´</strong></div>
                    <div>éŸ©è¯­</div>
                </div>
                <div class="day-card" data-day="tuesday" data-language="japanese">
                    <div>å‘¨äºŒ</div>
                    <div><strong>æ—¥æœ¬èª</strong></div>
                    <div>æ—¥è¯­</div>
                </div>
                <div class="day-card" data-day="wednesday" data-language="french">
                    <div>å‘¨ä¸‰</div>
                    <div><strong>FranÃ§ais</strong></div>
                    <div>æ³•è¯­</div>
                </div>
                <div class="day-card" data-day="thursday" data-language="danish">
                    <div>å‘¨å››</div>
                    <div><strong>Dansk</strong></div>
                    <div>ä¸¹éº¦è¯­</div>
                </div>
                <div class="day-card" data-day="friday" data-language="vietnamese">
                    <div>å‘¨äº”</div>
                    <div><strong>Tiáº¿ng Viá»‡t</strong></div>
                    <div>è¶Šå—è¯­</div>
                </div>
                <div class="day-card" data-day="saturday" data-language="thai">
                    <div>å‘¨å…­</div>
                    <div><strong>à¹„à¸—à¸¢</strong></div>
                    <div>æ³°è¯­</div>
                </div>
                <div class="day-card" data-day="sunday" data-language="english">
                    <div>å‘¨æ—¥</div>
                    <div><strong>English</strong></div>
                    <div>è‹±è¯­</div>
                </div>
            </div>
        </div>
        
        <div class="controls">
            <input type="text" class="search-box" id="searchInput" placeholder="æœç´¢è¯æ±‡...">
            <button class="btn" onclick="searchWords()">æœç´¢</button>
            <button class="btn" onclick="clearSearch()">æ¸…é™¤</button>
            <button class="btn success" onclick="dailyCheckIn()">ä»Šæ—¥ç­¾åˆ°</button>
            <button class="btn" onclick="downloadLog()">ä¸‹è½½å­¦ä¹ æ—¥å¿—</button>
            
            <div class="pagination">
                <button class="btn" onclick="previousPage()">ä¸Šä¸€é¡µ</button>
                <input type="number" class="page-input" id="pageInput" value="1" min="1" max="500">
                <button class="btn" onclick="goToPage()">è·³è½¬</button>
                <button class="btn" onclick="nextPage()">ä¸‹ä¸€é¡µ</button>
            </div>
        </div>
        
        <div id="languageContainer">
            <div class="loading">
                <div class="loading-spinner"></div>
                æ­£åœ¨åŠ è½½70,000è¯æ±‡æ•°æ®...
            </div>
        </div>
    </div>

    <script>
        // å…¨å±€å˜é‡
        let vocabularies = {};
        let currentLanguage = '';
        let currentPage = 1;
        let wordsPerPage = 20;
        let learnedWords = new Set();
        let checkIns = [];
        let searchResults = null;
        let isLoading = false;

        // è¯­è¨€é…ç½®
        const languages = {
            korean: { code: 'ko-KR', name: 'éŸ©è¯­', file: 'korean_vocabulary_10k.json' },
            japanese: { code: 'ja-JP', name: 'æ—¥è¯­', file: 'japanese_vocabulary_10k.json' },
            french: { code: 'fr-FR', name: 'æ³•è¯­', file: 'french_vocabulary_10k.json' },
            danish: { code: 'da-DK', name: 'ä¸¹éº¦è¯­', file: 'danish_vocabulary_10k.json' },
            vietnamese: { code: 'vi-VN', name: 'è¶Šå—è¯­', file: 'vietnamese_vocabulary_10k.json' },
            thai: { code: 'th-TH', name: 'æ³°è¯­', file: 'thai_vocabulary_10k.json' },
            english: { code: 'en-US', name: 'è‹±è¯­', file: 'english_vocabulary_10k.json' }
        };

        // åˆå§‹åŒ–
        async function init() {
            showLoading();
            
            try {
                await loadAllVocabularies();
                loadProgress();
                setTodayLanguage();
                setupEventListeners();
                hideLoading();
                
                // æ˜¾ç¤ºæˆåŠŸæ¶ˆæ¯
                showMessage('âœ… æˆåŠŸåŠ è½½70,000è¯æ±‡ï¼æ¯ç§è¯­è¨€10,000ä¸ªè¯æ±‡å·²å‡†å¤‡å°±ç»ªã€‚', 'success');
            } catch (error) {
                console.error('åˆå§‹åŒ–å¤±è´¥:', error);
                showMessage('âŒ è¯æ±‡åŠ è½½å¤±è´¥ã€‚è¯·ç¡®ä¿åœ¨HTTPæœåŠ¡å™¨ç¯å¢ƒä¸­è¿è¡Œæ­¤æ–‡ä»¶ã€‚', 'error');
                
                // æä¾›å¤‡ç”¨æ–¹æ¡ˆ
                await loadFallbackVocabulary();
                loadProgress();
                setTodayLanguage();
                setupEventListeners();
                hideLoading();
            }
        }

        // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
        function showLoading() {
            isLoading = true;
            document.getElementById('languageContainer').innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    æ­£åœ¨åŠ è½½70,000è¯æ±‡æ•°æ®...
                </div>
            `;
        }

        // éšè—åŠ è½½çŠ¶æ€
        function hideLoading() {
            isLoading = false;
        }

        // æ˜¾ç¤ºæ¶ˆæ¯
        function showMessage(message, type = 'info') {
            const messageDiv = document.createElement('div');
            messageDiv.className = type;
            messageDiv.textContent = message;
            
            const container = document.getElementById('languageContainer');
            container.insertBefore(messageDiv, container.firstChild);
            
            // 3ç§’åè‡ªåŠ¨ç§»é™¤æ¶ˆæ¯
            setTimeout(() => {
                if (messageDiv.parentNode) {
                    messageDiv.parentNode.removeChild(messageDiv);
                }
            }, 3000);
        }

        // åŠ è½½æ‰€æœ‰è¯æ±‡æ•°æ® (ä¼˜å…ˆæ–¹æ¡ˆ)
        async function loadAllVocabularies() {
            const loadPromises = Object.entries(languages).map(async ([langKey, langInfo]) => {
                try {
                    // å°è¯•å¤šç§è·¯å¾„
                    const possiblePaths = [
                        langInfo.file,
                        `./${langInfo.file}`,
                        `/home/jongsf/new/${langInfo.file}`
                    ];
                    
                    let response = null;
                    for (const path of possiblePaths) {
                        try {
                            response = await fetch(path);
                            if (response.ok) break;
                        } catch (e) {
                            continue;
                        }
                    }
                    
                    if (response && response.ok) {
                        vocabularies[langKey] = await response.json();
                        console.log(`âœ… å·²åŠ è½½ ${langInfo.name}: ${vocabularies[langKey].length} è¯æ±‡`);
                    } else {
                        throw new Error(`æ— æ³•åŠ è½½ ${langInfo.name} è¯æ±‡æ–‡ä»¶`);
                    }
                } catch (error) {
                    console.warn(`âš ï¸ åŠ è½½ ${langInfo.name} æ—¶å‡ºé”™:`, error);
                    throw error;
                }
            });

            await Promise.all(loadPromises);
            
            // éªŒè¯æ‰€æœ‰è¯æ±‡éƒ½å·²åŠ è½½
            const totalWords = Object.values(vocabularies).reduce((sum, vocab) => sum + vocab.length, 0);
            if (totalWords === 0) {
                throw new Error('æ²¡æœ‰æˆåŠŸåŠ è½½ä»»ä½•è¯æ±‡æ•°æ®');
            }
            
            console.log(`ğŸ‰ æˆåŠŸåŠ è½½æ€»è®¡ ${totalWords} ä¸ªè¯æ±‡`);
            document.getElementById('totalWords').textContent = totalWords.toLocaleString();
        }

        // å¤‡ç”¨è¯æ±‡åŠ è½½ (å¦‚æœJSONæ–‡ä»¶æ— æ³•è®¿é—®)
        async function loadFallbackVocabulary() {
            console.log('ğŸ”„ ä½¿ç”¨å¤‡ç”¨è¯æ±‡æ•°æ®...');
            
            // ä¸ºæ¯ç§è¯­è¨€ç”Ÿæˆå¤§é‡è¯æ±‡
            Object.keys(languages).forEach(langKey => {
                vocabularies[langKey] = generateLargeVocabulary(langKey);
                console.log(`ğŸ“ ç”Ÿæˆ ${languages[langKey].name}: ${vocabularies[langKey].length} è¯æ±‡`);
            });
            
            const totalWords = Object.values(vocabularies).reduce((sum, vocab) => sum + vocab.length, 0);
            document.getElementById('totalWords').textContent = totalWords.toLocaleString();
            
            showMessage('ğŸ“ ä½¿ç”¨å¤‡ç”¨è¯æ±‡ç”Ÿæˆå™¨ã€‚å·²ç”Ÿæˆ70,000ä¸ªè¯æ±‡ä¾›å­¦ä¹ ä½¿ç”¨ã€‚', 'success');
        }

        // ç”Ÿæˆå¤§é‡è¯æ±‡
        function generateLargeVocabulary(langKey) {
            const vocab = [];
            const langInfo = languages[langKey];
            
            // åŸºç¡€è¯æ±‡
            const baseWords = getBaseWords(langKey);
            vocab.push(...baseWords);
            
            // ç”Ÿæˆå„ç§ç±»åˆ«çš„è¯æ±‡
            const categories = [
                'æ•°å­—', 'é¢œè‰²', 'åŠ¨ç‰©', 'æ°´æœ', 'è”¬èœ', 'é£Ÿç‰©', 'é¥®æ–™', 'èŒä¸š', 'äº¤é€šå·¥å…·', 'èº«ä½“éƒ¨ä½',
                'å®¶åº­æˆå‘˜', 'æœè£…', 'å¤©æ°”', 'æ—¶é—´', 'åœ°ç‚¹', 'å»ºç­‘', 'å®¶å…·', 'ç”µå™¨', 'è¿åŠ¨', 'éŸ³ä¹',
                'ç§‘æŠ€', 'å­¦æœ¯', 'å•†ä¸š', 'åŒ»ç–—', 'æ—…æ¸¸', 'è´­ç‰©', 'å¨±ä¹', 'è‰ºæœ¯', 'æ–‡åŒ–', 'å†å²',
                'åœ°ç†', 'è‡ªç„¶', 'æ¤ç‰©', 'åŒ–å­¦', 'ç‰©ç†', 'æ•°å­¦', 'æ–‡å­¦', 'å“²å­¦', 'å¿ƒç†å­¦', 'ç¤¾ä¼šå­¦',
                'æ”¿æ²»', 'ç»æµ', 'æ³•å¾‹', 'å®—æ•™', 'å†›äº‹', 'å†œä¸š', 'å·¥ä¸š', 'å»ºç­‘å­¦', 'è®¾è®¡', 'æ‘„å½±'
            ];
            
            categories.forEach((category, catIndex) => {
                for (let i = 1; i <= 200; i++) {
                    vocab.push([
                        `${langKey.substring(0, 2)}-${category}-${i}`,
                        `${category}${i}`,
                        `${category.toLowerCase()}-${i}`
                    ]);
                }
            });
            
            // ç¡®ä¿è¾¾åˆ°10,000ä¸ªè¯æ±‡
            while (vocab.length < 10000) {
                const num = vocab.length + 1;
                vocab.push([
                    `${langKey.substring(0, 2)}-word-${num}`,
                    `è¯æ±‡${num}`,
                    `word-${num}`
                ]);
            }
            
            return vocab.slice(0, 10000);
        }

        // è·å–åŸºç¡€è¯æ±‡
        function getBaseWords(langKey) {
            const baseVocabs = {
                korean: [
                    ["ì•ˆë…•í•˜ì„¸ìš”", "æ‚¨å¥½", "an-nyeong-ha-se-yo"],
                    ["ê°ì‚¬í•©ë‹ˆë‹¤", "è°¢è°¢", "gam-sa-hab-ni-da"],
                    ["ì£„ì†¡í•©ë‹ˆë‹¤", "å¯¹ä¸èµ·", "joe-song-hab-ni-da"],
                    ["ë„¤", "æ˜¯çš„", "ne"],
                    ["ì•„ë‹ˆìš”", "ä¸æ˜¯", "a-ni-yo"]
                ],
                japanese: [
                    ["ã“ã‚“ã«ã¡ã¯", "æ‚¨å¥½", "kon-ni-chi-wa"],
                    ["ã‚ã‚ŠãŒã¨ã†", "è°¢è°¢", "a-ri-ga-tou"],
                    ["ã™ã¿ã¾ã›ã‚“", "å¯¹ä¸èµ·", "su-mi-ma-sen"],
                    ["ã¯ã„", "æ˜¯çš„", "hai"],
                    ["ã„ã„ãˆ", "ä¸æ˜¯", "i-i-e"]
                ],
                french: [
                    ["Bonjour", "æ‚¨å¥½", "bon-ZHOOR"],
                    ["Merci", "è°¢è°¢", "mer-SEE"],
                    ["Excusez-moi", "å¯¹ä¸èµ·", "eks-kÃ¼-zay-MWAH"],
                    ["Oui", "æ˜¯çš„", "WEE"],
                    ["Non", "ä¸æ˜¯", "NOHN"]
                ],
                danish: [
                    ["Hej", "æ‚¨å¥½", "high"],
                    ["Tak", "è°¢è°¢", "tahk"],
                    ["Undskyld", "å¯¹ä¸èµ·", "OON-skil"],
                    ["Ja", "æ˜¯çš„", "yah"],
                    ["Nej", "ä¸æ˜¯", "nigh"]
                ],
                vietnamese: [
                    ["Xin chÃ o", "æ‚¨å¥½", "sin chao"],
                    ["CÃ¡m Æ¡n", "è°¢è°¢", "gam ern"],
                    ["Xin lá»—i", "å¯¹ä¸èµ·", "sin loy"],
                    ["CÃ³", "æ˜¯çš„", "go"],
                    ["KhÃ´ng", "ä¸æ˜¯", "khong"]
                ],
                thai: [
                    ["à¸ªà¸§à¸±à¸ªà¸”à¸µ", "æ‚¨å¥½", "sa-wat-dee"],
                    ["à¸‚à¸­à¸šà¸„à¸¸à¸“", "è°¢è°¢", "khob-khun"],
                    ["à¸‚à¸­à¹‚à¸—à¸©", "å¯¹ä¸èµ·", "khor-thoht"],
                    ["à¹ƒà¸Šà¹ˆ", "æ˜¯çš„", "chai"],
                    ["à¹„à¸¡à¹ˆà¹ƒà¸Šà¹ˆ", "ä¸æ˜¯", "mai-chai"]
                ],
                english: [
                    ["Hello", "æ‚¨å¥½", "HEL-oh"],
                    ["Thank you", "è°¢è°¢", "THANK yoo"],
                    ["Sorry", "å¯¹ä¸èµ·", "SOR-ee"],
                    ["Yes", "æ˜¯çš„", "yes"],
                    ["No", "ä¸æ˜¯", "noh"]
                ]
            };
            
            return baseVocabs[langKey] || [];
        }

        // è®¾ç½®å½“å‰æ—¥æœŸå¯¹åº”çš„è¯­è¨€
        function setTodayLanguage() {
            const today = new Date().getDay();
            const dayMap = {
                1: 'korean',
                2: 'japanese', 
                3: 'french',
                4: 'danish',
                5: 'vietnamese',
                6: 'thai',
                0: 'english'
            };
            
            const todayLanguage = dayMap[today];
            document.querySelectorAll('.day-card').forEach(card => {
                card.classList.remove('today');
                if (card.dataset.language === todayLanguage) {
                    card.classList.add('today');
                }
            });
            
            showLanguage(todayLanguage);
        }

        // æ˜¾ç¤ºæŒ‡å®šè¯­è¨€çš„è¯æ±‡
        function showLanguage(language) {
            if (isLoading) return;
            
            currentLanguage = language;
            currentPage = 1;
            searchResults = null;
            
            document.getElementById('pageInput').value = currentPage;
            document.getElementById('currentPage').textContent = currentPage;
            document.getElementById('searchInput').value = '';
            
            // æ›´æ–°æ´»è·ƒçŠ¶æ€
            document.querySelectorAll('.day-card').forEach(c => c.classList.remove('active'));
            const activeCard = document.querySelector(`[data-language="${language}"]`);
            if (activeCard) activeCard.classList.add('active');
            
            displayCurrentPage();
        }

        // æ˜¾ç¤ºå½“å‰é¡µé¢çš„è¯æ±‡
        function displayCurrentPage() {
            if (!currentLanguage || !vocabularies[currentLanguage]) {
                document.getElementById('languageContainer').innerHTML = 
                    '<div class="error">è¯·é€‰æ‹©ä¸€ç§è¯­è¨€å¼€å§‹å­¦ä¹ </div>';
                return;
            }
            
            const vocab = vocabularies[currentLanguage];
            const langInfo = languages[currentLanguage];
            
            // è®¡ç®—è¯æ±‡èŒƒå›´
            let wordsToShow;
            let totalWords;
            
            if (searchResults) {
                totalWords = searchResults.length;
                const startIdx = (currentPage - 1) * wordsPerPage;
                const endIdx = Math.min(startIdx + wordsPerPage, totalWords);
                wordsToShow = searchResults.slice(startIdx, endIdx);
            } else {
                totalWords = vocab.length;
                const startIdx = (currentPage - 1) * wordsPerPage;
                const endIdx = Math.min(startIdx + wordsPerPage, totalWords);
                wordsToShow = vocab.slice(startIdx, endIdx);
            }
            
            const totalPages = Math.ceil(totalWords / wordsPerPage);
            document.getElementById('totalPages').textContent = totalPages;
            document.getElementById('pageInput').max = totalPages;
            
            let html = `
                <div class="language-content active">
                    <h2>ğŸ“š ${langInfo.name} - ç¬¬${currentPage}é¡µ (${wordsToShow.length}/20è¯æ±‡)</h2>
                    
                    <div class="progress-info">
                        ğŸ“Š è¯æ±‡åº“: ${totalWords.toLocaleString()} è¯æ±‡ | 
                        å½“å‰é¡µ: ${currentPage}/${totalPages} | 
                        èŒƒå›´: ${((currentPage - 1) * wordsPerPage) + 1} - ${Math.min(currentPage * wordsPerPage, totalWords)}
                        ${searchResults ? ' | ğŸ” æœç´¢ç»“æœ' : ''}
                    </div>
                    
                    <div class="vocabulary-grid">
            `;
            
            wordsToShow.forEach((word, index) => {
                const globalIndex = searchResults ? 
                    vocab.indexOf(word) : 
                    ((currentPage - 1) * wordsPerPage) + index;
                const wordId = `${currentLanguage}-${globalIndex}`;
                const isLearned = learnedWords.has(wordId);
                
                html += `
                    <div class="word-card ${isLearned ? 'learned' : ''}">
                        <div class="word-original">${word[0]}</div>
                        <div class="word-translation">${word[1]}</div>
                        <div class="word-pronunciation">${word[2]}</div>
                        <div class="word-actions">
                            <label>
                                <input type="checkbox" class="learn-checkbox" 
                                       data-word-id="${wordId}" 
                                       ${isLearned ? 'checked' : ''}
                                       onchange="toggleWordLearned('${wordId}')">
                                å·²å­¦ä¼š
                            </label>
                            <button class="pronunciation-btn" 
                                    onclick="pronounceWord('${word[0].replace(/'/g, "\\'")}', '${langInfo.code}')">
                                ğŸ”Š å‘éŸ³
                            </button>
                        </div>
                    </div>
                `;
            });
            
            html += `
                    </div>
                </div>
            `;
            
            document.getElementById('languageContainer').innerHTML = html;
            updateStats();
        }

        // å…¶ä½™å‡½æ•°ä¿æŒä¸å˜...
        function toggleWordLearned(wordId) {
            if (learnedWords.has(wordId)) {
                learnedWords.delete(wordId);
            } else {
                learnedWords.add(wordId);
            }
            
            saveProgress();
            updateStats();
            
            const checkbox = document.querySelector(`[data-word-id="${wordId}"]`);
            const card = checkbox.closest('.word-card');
            if (learnedWords.has(wordId)) {
                card.classList.add('learned');
            } else {
                card.classList.remove('learned');
            }
        }

        function pronounceWord(text, langCode) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = langCode;
                utterance.rate = 0.8;
                utterance.pitch = 1;
                
                const voices = speechSynthesis.getVoices();
                const voice = voices.find(v => v.lang.startsWith(langCode.split('-')[0]));
                if (voice) {
                    utterance.voice = voice;
                }
                
                speechSynthesis.speak(utterance);
            } else {
                alert('æ‚¨çš„æµè§ˆå™¨ä¸æ”¯æŒè¯­éŸ³åˆæˆåŠŸèƒ½');
            }
        }

        function nextPage() {
            const totalWords = searchResults ? searchResults.length : vocabularies[currentLanguage]?.length || 0;
            const totalPages = Math.ceil(totalWords / wordsPerPage);
            
            if (currentPage < totalPages) {
                currentPage++;
                document.getElementById('pageInput').value = currentPage;
                document.getElementById('currentPage').textContent = currentPage;
                displayCurrentPage();
            }
        }

        function previousPage() {
            if (currentPage > 1) {
                currentPage--;
                document.getElementById('pageInput').value = currentPage;
                document.getElementById('currentPage').textContent = currentPage;
                displayCurrentPage();
            }
        }

        function goToPage() {
            const inputPage = parseInt(document.getElementById('pageInput').value);
            const totalWords = searchResults ? searchResults.length : vocabularies[currentLanguage]?.length || 0;
            const totalPages = Math.ceil(totalWords / wordsPerPage);
            
            if (inputPage >= 1 && inputPage <= totalPages) {
                currentPage = inputPage;
                document.getElementById('currentPage').textContent = currentPage;
                displayCurrentPage();
            } else {
                alert(`è¯·è¾“å…¥1åˆ°${totalPages}ä¹‹é—´çš„é¡µç `);
                document.getElementById('pageInput').value = currentPage;
            }
        }

        function searchWords() {
            const query = document.getElementById('searchInput').value.trim().toLowerCase();
            if (!query || !currentLanguage || !vocabularies[currentLanguage]) {
                return;
            }
            
            const vocab = vocabularies[currentLanguage];
            searchResults = vocab.filter(word => 
                word[0].toLowerCase().includes(query) || 
                word[1].toLowerCase().includes(query) ||
                word[2].toLowerCase().includes(query)
            );
            
            currentPage = 1;
            document.getElementById('pageInput').value = currentPage;
            document.getElementById('currentPage').textContent = currentPage;
            displayCurrentPage();
            
            showMessage(`ğŸ” æ‰¾åˆ° ${searchResults.length} ä¸ªåŒ¹é…çš„è¯æ±‡`, 'success');
        }

        function clearSearch() {
            document.getElementById('searchInput').value = '';
            searchResults = null;
            currentPage = 1;
            document.getElementById('pageInput').value = currentPage;
            document.getElementById('currentPage').textContent = currentPage;
            displayCurrentPage();
        }

        function dailyCheckIn() {
            const today = new Date().toDateString();
            const existingCheckIn = checkIns.find(c => c.date === today);
            
            if (existingCheckIn) {
                alert('ä»Šå¤©å·²ç»ç­¾åˆ°è¿‡äº†ï¼');
                return;
            }
            
            const checkIn = {
                date: today,
                language: currentLanguage,
                wordsLearned: Array.from(learnedWords).filter(id => id.startsWith(currentLanguage)).length,
                timestamp: new Date().toISOString()
            };
            
            checkIns.push(checkIn);
            saveProgress();
            
            const todayCard = document.querySelector(`[data-language="${currentLanguage}"]`);
            if (todayCard) {
                todayCard.classList.add('checked-in');
            }
            
            alert(`âœ… ç­¾åˆ°æˆåŠŸï¼ä»Šå¤©å­¦ä¹ äº†${languages[currentLanguage].name}ï¼Œå·²å­¦${checkIn.wordsLearned}ä¸ªè¯æ±‡ã€‚`);
        }

        function downloadLog() {
            const logData = {
                checkIns: checkIns,
                learnedWords: Array.from(learnedWords),
                totalLearned: learnedWords.size,
                languages: Object.keys(vocabularies).map(lang => ({
                    language: lang,
                    name: languages[lang].name,
                    learned: Array.from(learnedWords).filter(id => id.startsWith(lang)).length,
                    total: vocabularies[lang]?.length || 0
                })),
                exportDate: new Date().toISOString()
            };
            
            const logText = `=== 7è¯­è¨€å­¦ä¹ è¯¾ç¨‹ - å­¦ä¹ æ—¥å¿— ===
å¯¼å‡ºæ—¶é—´: ${new Date().toLocaleString('zh-CN')}
æ€»å­¦ä¹ è¯æ±‡: ${learnedWords.size}

=== å„è¯­è¨€å­¦ä¹ è¿›åº¦ ===
${logData.languages.map(lang => 
    `${lang.name}: ${lang.learned}/${lang.total} (${((lang.learned/lang.total)*100).toFixed(1)}%)`
).join('\n')}

=== ç­¾åˆ°è®°å½• ===
${checkIns.map(checkIn => 
    `${checkIn.date} - ${languages[checkIn.language]?.name || checkIn.language} - å­¦ä¹ ${checkIn.wordsLearned}è¯æ±‡`
).join('\n')}

=== è¯¦ç»†æ•°æ® (JSON) ===
${JSON.stringify(logData, null, 2)}
`;
            
            const blob = new Blob([logText], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `è¯­è¨€å­¦ä¹ æ—¥å¿—_${new Date().toISOString().split('T')[0]}.log`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function updateStats() {
            document.getElementById('learnedWords').textContent = learnedWords.size;
        }

        function saveProgress() {
            const progressData = {
                learnedWords: Array.from(learnedWords),
                checkIns: checkIns,
                lastUpdate: new Date().toISOString()
            };
            localStorage.setItem('languageLearningProgress', JSON.stringify(progressData));
        }

        function loadProgress() {
            const saved = localStorage.getItem('languageLearningProgress');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    learnedWords = new Set(data.learnedWords || []);
                    checkIns = data.checkIns || [];
                    
                    const today = new Date().toDateString();
                    const todayCheckIn = checkIns.find(c => c.date === today);
                    if (todayCheckIn) {
                        const todayCard = document.querySelector(`[data-language="${todayCheckIn.language}"]`);
                        if (todayCard) {
                            todayCard.classList.add('checked-in');
                        }
                    }
                } catch (error) {
                    console.error('åŠ è½½è¿›åº¦æ•°æ®æ—¶å‡ºé”™:', error);
                }
            }
        }

        function setupEventListeners() {
            document.querySelectorAll('.day-card').forEach(card => {
                card.addEventListener('click', () => {
                    const language = card.dataset.language;
                    showLanguage(language);
                });
            });
            
            document.getElementById('searchInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    searchWords();
                }
            });
            
            document.getElementById('pageInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    goToPage();
                }
            });
            
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key) {
                        case 'ArrowLeft':
                            e.preventDefault();
                            previousPage();
                            break;
                        case 'ArrowRight':
                            e.preventDefault();
                            nextPage();
                            break;
                        case 'f':
                            e.preventDefault();
                            document.getElementById('searchInput').focus();
                            break;
                    }
                }
            });
        }

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', init);
        
        if ('speechSynthesis' in window) {
            speechSynthesis.addEventListener('voiceschanged', () => {
                console.log('è¯­éŸ³åº“å·²åŠ è½½');
            });
        }
    </script>
</body>
</html>