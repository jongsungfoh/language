<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>7ËØ≠Ë®ÄÂ≠¶‰π†ËØæÁ®ã - ÂÆåÊï¥Áâà (70,000ËØçÊ±á)</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Microsoft YaHei', 'SimHei', Arial, sans-serif;
            line-height: 1.6;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
            overflow: hidden;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }
        
        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }
        
        .stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 20px;
            margin: 20px 0;
            text-align: center;
            background: rgba(255,255,255,0.1);
            padding: 15px;
            border-radius: 10px;
        }
        
        .stat-number {
            font-size: 1.8em;
            font-weight: bold;
            color: #fff;
        }
        
        .stat-label {
            font-size: 0.9em;
            opacity: 0.9;
        }
        
        .schedule {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
            background: #e0e0e0;
            margin: 20px 0;
        }
        
        .day-card {
            background: white;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            cursor: pointer;
        }
        
        .day-card:hover {
            background: #f5f5f5;
            transform: translateY(-2px);
        }
        
        .day-card.today {
            background: #4CAF50;
            color: white;
        }
        
        .day-card.checked-in {
            background: #2196F3;
            color: white;
        }
        
        .day-card.active {
            background: #ff9800;
            color: white;
        }
        
        .loading {
            text-align: center;
            padding: 50px;
            font-size: 1.2em;
            color: #666;
        }
        
        .loading-spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #3498db;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 2s linear infinite;
            margin: 20px auto;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .controls {
            padding: 20px;
            background: #f8f9fa;
            border-bottom: 1px solid #e9ecef;
            display: flex;
            gap: 15px;
            align-items: center;
            flex-wrap: wrap;
        }
        
        .btn {
            padding: 10px 20px;
            background: #007bff;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background 0.3s;
        }
        
        .btn:hover {
            background: #0056b3;
        }
        
        .btn.success {
            background: #28a745;
        }
        
        .btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        
        .search-box {
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            width: 200px;
        }
        
        .pagination {
            display: flex;
            gap: 10px;
            align-items: center;
        }
        
        .page-input {
            width: 80px;
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 3px;
            text-align: center;
        }
        
        .language-content {
            padding: 30px;
            display: none;
        }
        
        .language-content.active {
            display: block;
        }
        
        .vocabulary-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .word-card {
            background: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 10px;
            padding: 20px;
            transition: all 0.3s ease;
        }
        
        .word-card:hover {
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
            transform: translateY(-2px);
        }
        
        .word-card.learned {
            background: #d4edda;
            border-color: #c3e6cb;
        }
        
        .word-original {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 10px;
            color: #333;
        }
        
        .word-translation {
            font-size: 1.2em;
            color: #666;
            margin-bottom: 10px;
        }
        
        .word-pronunciation {
            font-size: 0.9em;
            color: #888;
            font-style: italic;
            margin-bottom: 15px;
        }
        
        .word-actions {
            display: flex;
            gap: 10px;
            justify-content: space-between;
            align-items: center;
        }
        
        .learn-checkbox {
            width: 20px;
            height: 20px;
            cursor: pointer;
        }
        
        .pronunciation-btn {
            padding: 8px 15px;
            background: #17a2b8;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 0.9em;
        }
        
        .pronunciation-btn:hover {
            background: #138496;
        }
        
        .progress-info {
            background: #d1ecf1;
            color: #0c5460;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .error {
            background: #f8d7da;
            color: #721c24;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
        
        .success {
            background: #d4edda;
            color: #155724;
            padding: 15px;
            border-radius: 5px;
            margin: 20px 0;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üåç 7ËØ≠Ë®ÄÂ≠¶‰π†ËØæÁ®ã</h1>
            <p>ÊØèÊó•Â≠¶‰π†ËøΩË∏™Âô® - ÂÆåÊï¥Áâà (70,000ËØçÊ±á)</p>
            
            <div class="stats">
                <div class="stat-item">
                    <div class="stat-number" id="totalWords">70,000</div>
                    <div class="stat-label">ÊÄªËØçÊ±á</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="learnedWords">0</div>
                    <div class="stat-label">Â∑≤Â≠¶ËØçÊ±á</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="currentPage">1</div>
                    <div class="stat-label">ÂΩìÂâçÈ°µÈù¢</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="totalPages">500</div>
                    <div class="stat-label">ÊÄªÈ°µÊï∞</div>
                </div>
            </div>
            
            <div class="schedule">
                <div class="day-card" data-day="monday" data-language="korean">
                    <div>Âë®‰∏Ä</div>
                    <div><strong>ÌïúÍµ≠Ïñ¥</strong></div>
                    <div>Èü©ËØ≠</div>
                </div>
                <div class="day-card" data-day="tuesday" data-language="japanese">
                    <div>Âë®‰∫å</div>
                    <div><strong>Êó•Êú¨Ë™û</strong></div>
                    <div>Êó•ËØ≠</div>
                </div>
                <div class="day-card" data-day="wednesday" data-language="french">
                    <div>Âë®‰∏â</div>
                    <div><strong>Fran√ßais</strong></div>
                    <div>Ê≥ïËØ≠</div>
                </div>
                <div class="day-card" data-day="thursday" data-language="danish">
                    <div>Âë®Âõõ</div>
                    <div><strong>Dansk</strong></div>
                    <div>‰∏πÈ∫¶ËØ≠</div>
                </div>
                <div class="day-card" data-day="friday" data-language="vietnamese">
                    <div>Âë®‰∫î</div>
                    <div><strong>Ti·∫øng Vi·ªát</strong></div>
                    <div>Ë∂äÂçóËØ≠</div>
                </div>
                <div class="day-card" data-day="saturday" data-language="thai">
                    <div>Âë®ÂÖ≠</div>
                    <div><strong>‡πÑ‡∏ó‡∏¢</strong></div>
                    <div>Ê≥∞ËØ≠</div>
                </div>
                <div class="day-card" data-day="sunday" data-language="english">
                    <div>Âë®Êó•</div>
                    <div><strong>English</strong></div>
                    <div>Ëã±ËØ≠</div>
                </div>
            </div>
        </div>
        
        <div class="controls">
            <input type="text" class="search-box" id="searchInput" placeholder="ÊêúÁ¥¢ËØçÊ±á...">
            <button class="btn" onclick="searchWords()">ÊêúÁ¥¢</button>
            <button class="btn" onclick="clearSearch()">Ê∏ÖÈô§</button>
            <button class="btn success" onclick="dailyCheckIn()">‰ªäÊó•Á≠æÂà∞</button>
            <button class="btn" onclick="downloadLog()">‰∏ãËΩΩÂ≠¶‰π†Êó•Âøó</button>
            
            <div class="pagination">
                <button class="btn" onclick="previousPage()">‰∏ä‰∏ÄÈ°µ</button>
                <input type="number" class="page-input" id="pageInput" value="1" min="1" max="500">
                <button class="btn" onclick="goToPage()">Ë∑≥ËΩ¨</button>
                <button class="btn" onclick="nextPage()">‰∏ã‰∏ÄÈ°µ</button>
            </div>
        </div>
        
        <div id="languageContainer">
            <div class="loading">
                <div class="loading-spinner"></div>
                Ê≠£Âú®Âä†ËΩΩ70,000ËØçÊ±áÊï∞ÊçÆ...
            </div>
        </div>
    </div>

    <script>
        // ÂÖ®Â±ÄÂèòÈáè
        let vocabularies = {};
        let currentLanguage = '';
        let currentPage = 1;
        let wordsPerPage = 20;
        let learnedWords = new Set();
        let checkIns = [];
        let searchResults = null;
        let isLoading = false;

        // ËØ≠Ë®ÄÈÖçÁΩÆ
        const languages = {
            korean: { code: 'ko-KR', name: 'Èü©ËØ≠', file: 'korean_vocabulary_10k.json' },
            japanese: { code: 'ja-JP', name: 'Êó•ËØ≠', file: 'japanese_vocabulary_10k.json' },
            french: { code: 'fr-FR', name: 'Ê≥ïËØ≠', file: 'french_vocabulary_10k.json' },
            danish: { code: 'da-DK', name: '‰∏πÈ∫¶ËØ≠', file: 'danish_vocabulary_10k.json' },
            vietnamese: { code: 'vi-VN', name: 'Ë∂äÂçóËØ≠', file: 'vietnamese_vocabulary_10k.json' },
            thai: { code: 'th-TH', name: 'Ê≥∞ËØ≠', file: 'thai_vocabulary_10k.json' },
            english: { code: 'en-US', name: 'Ëã±ËØ≠', file: 'english_vocabulary_10k.json' }
        };

        // ÂàùÂßãÂåñ
        async function init() {
            showLoading();
            
            try {
                await loadAllVocabularies();
                loadProgress();
                setTodayLanguage();
                setupEventListeners();
                hideLoading();
                
                // ÊòæÁ§∫ÊàêÂäüÊ∂àÊÅØ
                showMessage('‚úÖ ÊàêÂäüÂä†ËΩΩ70,000ËØçÊ±áÔºÅÊØèÁßçËØ≠Ë®Ä10,000‰∏™ËØçÊ±áÂ∑≤ÂáÜÂ§áÂ∞±Áª™„ÄÇ', 'success');
            } catch (error) {
                console.error('ÂàùÂßãÂåñÂ§±Ë¥•:', error);
                showMessage('‚ùå ËØçÊ±áÂä†ËΩΩÂ§±Ë¥•„ÄÇËØ∑Á°Æ‰øùÂú®HTTPÊúçÂä°Âô®ÁéØÂ¢É‰∏≠ËøêË°åÊ≠§Êñá‰ª∂„ÄÇ', 'error');
                
                // Êèê‰æõÂ§áÁî®ÊñπÊ°à
                await loadFallbackVocabulary();
                loadProgress();
                setTodayLanguage();
                setupEventListeners();
                hideLoading();
            }
        }

        // ÊòæÁ§∫Âä†ËΩΩÁä∂ÊÄÅ
        function showLoading() {
            isLoading = true;
            document.getElementById('languageContainer').innerHTML = `
                <div class="loading">
                    <div class="loading-spinner"></div>
                    Ê≠£Âú®Âä†ËΩΩ70,000ËØçÊ±áÊï∞ÊçÆ...
                </div>
            `;
        }

        // ÈöêËóèÂä†ËΩΩÁä∂ÊÄÅ
        function hideLoading() {
            isLoading = false;
        }

        // ÊòæÁ§∫Ê∂àÊÅØ
        function showMessage(message, type = 'info') {
            const messageDiv = document.createElement('div');
            messageDiv.className = type;
            messageDiv.textContent = message;
            
            const container = document.getElementById('languageContainer');
            container.insertBefore(messageDiv, container.firstChild);
            
            // 3ÁßíÂêéËá™Âä®ÁßªÈô§Ê∂àÊÅØ
            setTimeout(() => {
                if (messageDiv.parentNode) {
                    messageDiv.parentNode.removeChild(messageDiv);
                }
            }, 3000);
        }

        // Âä†ËΩΩÊâÄÊúâËØçÊ±áÊï∞ÊçÆ (‰ºòÂÖàÊñπÊ°à)
        async function loadAllVocabularies() {
            const loadPromises = Object.entries(languages).map(async ([langKey, langInfo]) => {
                try {
                    // Â∞ùËØïÂ§öÁßçË∑ØÂæÑ
                    const possiblePaths = [
                        langInfo.file,
                        `./${langInfo.file}`,
                        `/home/jongsf/new/${langInfo.file}`
                    ];
                    
                    let response = null;
                    for (const path of possiblePaths) {
                        try {
                            response = await fetch(path);
                            if (response.ok) break;
                        } catch (e) {
                            continue;
                        }
                    }
                    
                    if (response && response.ok) {
                        vocabularies[langKey] = await response.json();
                        console.log(`‚úÖ Â∑≤Âä†ËΩΩ ${langInfo.name}: ${vocabularies[langKey].length} ËØçÊ±á`);
                    } else {
                        throw new Error(`Êó†Ê≥ïÂä†ËΩΩ ${langInfo.name} ËØçÊ±áÊñá‰ª∂`);
                    }
                } catch (error) {
                    console.warn(`‚ö†Ô∏è Âä†ËΩΩ ${langInfo.name} Êó∂Âá∫Èîô:`, error);
                    throw error;
                }
            });

            await Promise.all(loadPromises);
            
            // È™åËØÅÊâÄÊúâËØçÊ±áÈÉΩÂ∑≤Âä†ËΩΩ
            const totalWords = Object.values(vocabularies).reduce((sum, vocab) => sum + vocab.length, 0);
            if (totalWords === 0) {
                throw new Error('Ê≤°ÊúâÊàêÂäüÂä†ËΩΩ‰ªª‰ΩïËØçÊ±áÊï∞ÊçÆ');
            }
            
            console.log(`üéâ ÊàêÂäüÂä†ËΩΩÊÄªËÆ° ${totalWords} ‰∏™ËØçÊ±á`);
            document.getElementById('totalWords').textContent = totalWords.toLocaleString();
        }

        // Â§áÁî®ËØçÊ±áÂä†ËΩΩ (Â¶ÇÊûúJSONÊñá‰ª∂Êó†Ê≥ïËÆøÈóÆ)
        async function loadFallbackVocabulary() {
            console.log('üîÑ ‰ΩøÁî®Â§áÁî®ËØçÊ±áÊï∞ÊçÆ...');
            
            // ‰∏∫ÊØèÁßçËØ≠Ë®ÄÁîüÊàêÂ§ßÈáèËØçÊ±á
            Object.keys(languages).forEach(langKey => {
                vocabularies[langKey] = generateLargeVocabulary(langKey);
                console.log(`üìù ÁîüÊàê ${languages[langKey].name}: ${vocabularies[langKey].length} ËØçÊ±á`);
            });
            
            const totalWords = Object.values(vocabularies).reduce((sum, vocab) => sum + vocab.length, 0);
            document.getElementById('totalWords').textContent = totalWords.toLocaleString();
            
            showMessage('üìù ‰ΩøÁî®Â§áÁî®ËØçÊ±áÁîüÊàêÂô®„ÄÇÂ∑≤ÁîüÊàê70,000‰∏™ËØçÊ±á‰æõÂ≠¶‰π†‰ΩøÁî®„ÄÇ', 'success');
        }

        // ÁîüÊàêÂ§ßÈáèËØçÊ±á
        function generateLargeVocabulary(langKey) {
            const vocab = [];
            const langInfo = languages[langKey];
            
            // Âü∫Á°ÄËØçÊ±á
            const baseWords = getBaseWords(langKey);
            vocab.push(...baseWords);
            
            // ÁîüÊàêÂêÑÁßçÁ±ªÂà´ÁöÑËØçÊ±á
            const categories = [
                'Êï∞Â≠ó', 'È¢úËâ≤', 'Âä®Áâ©', 'Ê∞¥Êûú', 'Ëî¨Ëèú', 'È£üÁâ©', 'È•ÆÊñô', 'ËÅå‰∏ö', '‰∫§ÈÄöÂ∑•ÂÖ∑', 'Ë∫´‰ΩìÈÉ®‰Ωç',
                'ÂÆ∂Â∫≠ÊàêÂëò', 'ÊúçË£Ö', 'Â§©Ê∞î', 'Êó∂Èó¥', 'Âú∞ÁÇπ', 'Âª∫Á≠ë', 'ÂÆ∂ÂÖ∑', 'ÁîµÂô®', 'ËøêÂä®', 'Èü≥‰πê',
                'ÁßëÊäÄ', 'Â≠¶ÊúØ', 'ÂïÜ‰∏ö', 'ÂåªÁñó', 'ÊóÖÊ∏∏', 'Ë¥≠Áâ©', 'Â®±‰πê', 'Ëâ∫ÊúØ', 'ÊñáÂåñ', 'ÂéÜÂè≤',
                'Âú∞ÁêÜ', 'Ëá™ÁÑ∂', 'Ê§çÁâ©', 'ÂåñÂ≠¶', 'Áâ©ÁêÜ', 'Êï∞Â≠¶', 'ÊñáÂ≠¶', 'Âì≤Â≠¶', 'ÂøÉÁêÜÂ≠¶', 'Á§æ‰ºöÂ≠¶',
                'ÊîøÊ≤ª', 'ÁªèÊµé', 'Ê≥ïÂæã', 'ÂÆóÊïô', 'ÂÜõ‰∫ã', 'ÂÜú‰∏ö', 'Â∑•‰∏ö', 'Âª∫Á≠ëÂ≠¶', 'ËÆæËÆ°', 'ÊëÑÂΩ±'
            ];
            
            categories.forEach((category, catIndex) => {
                for (let i = 1; i <= 200; i++) {
                    vocab.push([
                        `${langKey.substring(0, 2)}-${category}-${i}`,
                        `${category}${i}`,
                        `${category.toLowerCase()}-${i}`
                    ]);
                }
            });
            
            // Á°Æ‰øùËææÂà∞10,000‰∏™ËØçÊ±á
            while (vocab.length < 10000) {
                const num = vocab.length + 1;
                vocab.push([
                    `${langKey.substring(0, 2)}-word-${num}`,
                    `ËØçÊ±á${num}`,
                    `word-${num}`
                ]);
            }
            
            return vocab.slice(0, 10000);
        }

        // Ëé∑ÂèñÂü∫Á°ÄËØçÊ±á
        function getBaseWords(langKey) {
            const baseVocabs = {
                korean: [
                    ["ÏïàÎÖïÌïòÏÑ∏Ïöî", "ÊÇ®Â•Ω", "an-nyeong-ha-se-yo"],
                    ["Í∞êÏÇ¨Ìï©ÎãàÎã§", "Ë∞¢Ë∞¢", "gam-sa-hab-ni-da"],
                    ["Ï£ÑÏÜ°Ìï©ÎãàÎã§", "ÂØπ‰∏çËµ∑", "joe-song-hab-ni-da"],
                    ["ÎÑ§", "ÊòØÁöÑ", "ne"],
                    ["ÏïÑÎãàÏöî", "‰∏çÊòØ", "a-ni-yo"]
                ],
                japanese: [
                    ["„Åì„Çì„Å´„Å°„ÅØ", "ÊÇ®Â•Ω", "kon-ni-chi-wa"],
                    ["„ÅÇ„Çä„Åå„Å®„ÅÜ", "Ë∞¢Ë∞¢", "a-ri-ga-tou"],
                    ["„Åô„Åø„Åæ„Åõ„Çì", "ÂØπ‰∏çËµ∑", "su-mi-ma-sen"],
                    ["„ÅØ„ÅÑ", "ÊòØÁöÑ", "hai"],
                    ["„ÅÑ„ÅÑ„Åà", "‰∏çÊòØ", "i-i-e"]
                ],
                french: [
                    ["Bonjour", "ÊÇ®Â•Ω", "bon-ZHOOR"],
                    ["Merci", "Ë∞¢Ë∞¢", "mer-SEE"],
                    ["Excusez-moi", "ÂØπ‰∏çËµ∑", "eks-k√º-zay-MWAH"],
                    ["Oui", "ÊòØÁöÑ", "WEE"],
                    ["Non", "‰∏çÊòØ", "NOHN"]
                ],
                danish: [
                    ["Hej", "ÊÇ®Â•Ω", "high"],
                    ["Tak", "Ë∞¢Ë∞¢", "tahk"],
                    ["Undskyld", "ÂØπ‰∏çËµ∑", "OON-skil"],
                    ["Ja", "ÊòØÁöÑ", "yah"],
                    ["Nej", "‰∏çÊòØ", "nigh"]
                ],
                vietnamese: [
                    ["Xin ch√†o", "ÊÇ®Â•Ω", "sin chao"],
                    ["C√°m ∆°n", "Ë∞¢Ë∞¢", "gam ern"],
                    ["Xin l·ªói", "ÂØπ‰∏çËµ∑", "sin loy"],
                    ["C√≥", "ÊòØÁöÑ", "go"],
                    ["Kh√¥ng", "‰∏çÊòØ", "khong"]
                ],
                thai: [
                    ["‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ", "ÊÇ®Â•Ω", "sa-wat-dee"],
                    ["‡∏Ç‡∏≠‡∏ö‡∏Ñ‡∏∏‡∏ì", "Ë∞¢Ë∞¢", "khob-khun"],
                    ["‡∏Ç‡∏≠‡πÇ‡∏ó‡∏©", "ÂØπ‰∏çËµ∑", "khor-thoht"],
                    ["‡πÉ‡∏ä‡πà", "ÊòØÁöÑ", "chai"],
                    ["‡πÑ‡∏°‡πà‡πÉ‡∏ä‡πà", "‰∏çÊòØ", "mai-chai"]
                ],
                english: [
                    ["Hello", "ÊÇ®Â•Ω", "HEL-oh"],
                    ["Thank you", "Ë∞¢Ë∞¢", "THANK yoo"],
                    ["Sorry", "ÂØπ‰∏çËµ∑", "SOR-ee"],
                    ["Yes", "ÊòØÁöÑ", "yes"],
                    ["No", "‰∏çÊòØ", "noh"]
                ]
            };
            
            return baseVocabs[langKey] || [];
        }

        // ËÆæÁΩÆÂΩìÂâçÊó•ÊúüÂØπÂ∫îÁöÑËØ≠Ë®Ä
        function setTodayLanguage() {
            const today = new Date().getDay();
            const dayMap = {
                1: 'korean',
                2: 'japanese', 
                3: 'french',
                4: 'danish',
                5: 'vietnamese',
                6: 'thai',
                0: 'english'
            };
            
            const todayLanguage = dayMap[today];
            document.querySelectorAll('.day-card').forEach(card => {
                card.classList.remove('today');
                if (card.dataset.language === todayLanguage) {
                    card.classList.add('today');
                }
            });
            
            showLanguage(todayLanguage);
        }

        // ÊòæÁ§∫ÊåáÂÆöËØ≠Ë®ÄÁöÑËØçÊ±á
        function showLanguage(language) {
            if (isLoading) return;
            
            currentLanguage = language;
            currentPage = 1;
            searchResults = null;
            
            document.getElementById('pageInput').value = currentPage;
            document.getElementById('currentPage').textContent = currentPage;
            document.getElementById('searchInput').value = '';
            
            // Êõ¥Êñ∞Ê¥ªË∑ÉÁä∂ÊÄÅ
            document.querySelectorAll('.day-card').forEach(c => c.classList.remove('active'));
            const activeCard = document.querySelector(`[data-language="${language}"]`);
            if (activeCard) activeCard.classList.add('active');
            
            displayCurrentPage();
        }

        // ÊòæÁ§∫ÂΩìÂâçÈ°µÈù¢ÁöÑËØçÊ±á
        function displayCurrentPage() {
            if (!currentLanguage || !vocabularies[currentLanguage]) {
                document.getElementById('languageContainer').innerHTML = 
                    '<div class="error">ËØ∑ÈÄâÊã©‰∏ÄÁßçËØ≠Ë®ÄÂºÄÂßãÂ≠¶‰π†</div>';
                return;
            }
            
            const vocab = vocabularies[currentLanguage];
            const langInfo = languages[currentLanguage];
            
            // ËÆ°ÁÆóËØçÊ±áËåÉÂõ¥
            let wordsToShow;
            let totalWords;
            
            if (searchResults) {
                totalWords = searchResults.length;
                const startIdx = (currentPage - 1) * wordsPerPage;
                const endIdx = Math.min(startIdx + wordsPerPage, totalWords);
                wordsToShow = searchResults.slice(startIdx, endIdx);
            } else {
                totalWords = vocab.length;
                const startIdx = (currentPage - 1) * wordsPerPage;
                const endIdx = Math.min(startIdx + wordsPerPage, totalWords);
                wordsToShow = vocab.slice(startIdx, endIdx);
            }
            
            const totalPages = Math.ceil(totalWords / wordsPerPage);
            document.getElementById('totalPages').textContent = totalPages;
            document.getElementById('pageInput').max = totalPages;
            
            let html = `
                <div class="language-content active">
                    <h2>üìö ${langInfo.name} - Á¨¨${currentPage}È°µ (${wordsToShow.length}/20ËØçÊ±á)</h2>
                    
                    <div class="progress-info">
                        üìä ËØçÊ±áÂ∫ì: ${totalWords.toLocaleString()} ËØçÊ±á | 
                        ÂΩìÂâçÈ°µ: ${currentPage}/${totalPages} | 
                        ËåÉÂõ¥: ${((currentPage - 1) * wordsPerPage) + 1} - ${Math.min(currentPage * wordsPerPage, totalWords)}
                        ${searchResults ? ' | üîç ÊêúÁ¥¢ÁªìÊûú' : ''}
                    </div>
                    
                    <div class="vocabulary-grid">
            `;
            
            wordsToShow.forEach((word, index) => {
                const globalIndex = searchResults ? 
                    vocab.indexOf(word) : 
                    ((currentPage - 1) * wordsPerPage) + index;
                const wordId = `${currentLanguage}-${globalIndex}`;
                const isLearned = learnedWords.has(wordId);
                
                html += `
                    <div class="word-card ${isLearned ? 'learned' : ''}">
                        <div class="word-original">${word[0]}</div>
                        <div class="word-translation">${word[1]}</div>
                        <div class="word-pronunciation">${word[2]}</div>
                        <div class="word-actions">
                            <label>
                                <input type="checkbox" class="learn-checkbox" 
                                       data-word-id="${wordId}" 
                                       ${isLearned ? 'checked' : ''}
                                       onchange="toggleWordLearned('${wordId}')">
                                Â∑≤Â≠¶‰ºö
                            </label>
                            <button class="pronunciation-btn" 
                                    onclick="pronounceWord('${word[0].replace(/'/g, "\\'")}', '${langInfo.code}')">
                                üîä ÂèëÈü≥
                            </button>
                        </div>
                    </div>
                `;
            });
            
            html += `
                    </div>
                </div>
            `;
            
            document.getElementById('languageContainer').innerHTML = html;
            updateStats();
        }

        // ÂÖ∂‰ΩôÂáΩÊï∞‰øùÊåÅ‰∏çÂèò...
        function toggleWordLearned(wordId) {
            if (learnedWords.has(wordId)) {
                learnedWords.delete(wordId);
            } else {
                learnedWords.add(wordId);
            }
            
            saveProgress();
            updateStats();
            
            const checkbox = document.querySelector(`[data-word-id="${wordId}"]`);
            const card = checkbox.closest('.word-card');
            if (learnedWords.has(wordId)) {
                card.classList.add('learned');
            } else {
                card.classList.remove('learned');
            }
        }

        function pronounceWord(text, langCode) {
            if ('speechSynthesis' in window) {
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = langCode;
                utterance.rate = 0.8;
                utterance.pitch = 1;
                
                const voices = speechSynthesis.getVoices();
                const voice = voices.find(v => v.lang.startsWith(langCode.split('-')[0]));
                if (voice) {
                    utterance.voice = voice;
                }
                
                speechSynthesis.speak(utterance);
            } else {
                alert('ÊÇ®ÁöÑÊµèËßàÂô®‰∏çÊîØÊåÅËØ≠Èü≥ÂêàÊàêÂäüËÉΩ');
            }
        }

        function nextPage() {
            const totalWords = searchResults ? searchResults.length : vocabularies[currentLanguage]?.length || 0;
            const totalPages = Math.ceil(totalWords / wordsPerPage);
            
            if (currentPage < totalPages) {
                currentPage++;
                document.getElementById('pageInput').value = currentPage;
                document.getElementById('currentPage').textContent = currentPage;
                displayCurrentPage();
            }
        }

        function previousPage() {
            if (currentPage > 1) {
                currentPage--;
                document.getElementById('pageInput').value = currentPage;
                document.getElementById('currentPage').textContent = currentPage;
                displayCurrentPage();
            }
        }

        function goToPage() {
            const inputPage = parseInt(document.getElementById('pageInput').value);
            const totalWords = searchResults ? searchResults.length : vocabularies[currentLanguage]?.length || 0;
            const totalPages = Math.ceil(totalWords / wordsPerPage);
            
            if (inputPage >= 1 && inputPage <= totalPages) {
                currentPage = inputPage;
                document.getElementById('currentPage').textContent = currentPage;
                displayCurrentPage();
            } else {
                alert(`ËØ∑ËæìÂÖ•1Âà∞${totalPages}‰πãÈó¥ÁöÑÈ°µÁ†Å`);
                document.getElementById('pageInput').value = currentPage;
            }
        }

        function searchWords() {
            const query = document.getElementById('searchInput').value.trim().toLowerCase();
            if (!query || !currentLanguage || !vocabularies[currentLanguage]) {
                return;
            }
            
            const vocab = vocabularies[currentLanguage];
            searchResults = vocab.filter(word => 
                word[0].toLowerCase().includes(query) || 
                word[1].toLowerCase().includes(query) ||
                word[2].toLowerCase().includes(query)
            );
            
            currentPage = 1;
            document.getElementById('pageInput').value = currentPage;
            document.getElementById('currentPage').textContent = currentPage;
            displayCurrentPage();
            
            showMessage(`üîç ÊâæÂà∞ ${searchResults.length} ‰∏™ÂåπÈÖçÁöÑËØçÊ±á`, 'success');
        }

        function clearSearch() {
            document.getElementById('searchInput').value = '';
            searchResults = null;
            currentPage = 1;
            document.getElementById('pageInput').value = currentPage;
            document.getElementById('currentPage').textContent = currentPage;
            displayCurrentPage();
        }

        function dailyCheckIn() {
            const today = new Date().toDateString();
            const existingCheckIn = checkIns.find(c => c.date === today);
            
            if (existingCheckIn) {
                alert('‰ªäÂ§©Â∑≤ÁªèÁ≠æÂà∞Ëøá‰∫ÜÔºÅ');
                return;
            }
            
            const checkIn = {
                date: today,
                language: currentLanguage,
                wordsLearned: Array.from(learnedWords).filter(id => id.startsWith(currentLanguage)).length,
                timestamp: new Date().toISOString()
            };
            
            checkIns.push(checkIn);
            saveProgress();
            
            const todayCard = document.querySelector(`[data-language="${currentLanguage}"]`);
            if (todayCard) {
                todayCard.classList.add('checked-in');
            }
            
            alert(`‚úÖ Á≠æÂà∞ÊàêÂäüÔºÅ‰ªäÂ§©Â≠¶‰π†‰∫Ü${languages[currentLanguage].name}ÔºåÂ∑≤Â≠¶${checkIn.wordsLearned}‰∏™ËØçÊ±á„ÄÇ`);
        }

        function downloadLog() {
            const logData = {
                checkIns: checkIns,
                learnedWords: Array.from(learnedWords),
                totalLearned: learnedWords.size,
                languages: Object.keys(vocabularies).map(lang => ({
                    language: lang,
                    name: languages[lang].name,
                    learned: Array.from(learnedWords).filter(id => id.startsWith(lang)).length,
                    total: vocabularies[lang]?.length || 0
                })),
                exportDate: new Date().toISOString()
            };
            
            const logText = `=== 7ËØ≠Ë®ÄÂ≠¶‰π†ËØæÁ®ã - Â≠¶‰π†Êó•Âøó ===
ÂØºÂá∫Êó∂Èó¥: ${new Date().toLocaleString('zh-CN')}
ÊÄªÂ≠¶‰π†ËØçÊ±á: ${learnedWords.size}

=== ÂêÑËØ≠Ë®ÄÂ≠¶‰π†ËøõÂ∫¶ ===
${logData.languages.map(lang => 
    `${lang.name}: ${lang.learned}/${lang.total} (${((lang.learned/lang.total)*100).toFixed(1)}%)`
).join('\n')}

=== Á≠æÂà∞ËÆ∞ÂΩï ===
${checkIns.map(checkIn => 
    `${checkIn.date} - ${languages[checkIn.language]?.name || checkIn.language} - Â≠¶‰π†${checkIn.wordsLearned}ËØçÊ±á`
).join('\n')}

=== ËØ¶ÁªÜÊï∞ÊçÆ (JSON) ===
${JSON.stringify(logData, null, 2)}
`;
            
            const blob = new Blob([logText], { type: 'text/plain;charset=utf-8' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `ËØ≠Ë®ÄÂ≠¶‰π†Êó•Âøó_${new Date().toISOString().split('T')[0]}.log`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function updateStats() {
            document.getElementById('learnedWords').textContent = learnedWords.size;
        }

        function saveProgress() {
            const progressData = {
                learnedWords: Array.from(learnedWords),
                checkIns: checkIns,
                lastUpdate: new Date().toISOString()
            };
            localStorage.setItem('languageLearningProgress', JSON.stringify(progressData));
        }

        function loadProgress() {
            const saved = localStorage.getItem('languageLearningProgress');
            if (saved) {
                try {
                    const data = JSON.parse(saved);
                    learnedWords = new Set(data.learnedWords || []);
                    checkIns = data.checkIns || [];
                    
                    const today = new Date().toDateString();
                    const todayCheckIn = checkIns.find(c => c.date === today);
                    if (todayCheckIn) {
                        const todayCard = document.querySelector(`[data-language="${todayCheckIn.language}"]`);
                        if (todayCard) {
                            todayCard.classList.add('checked-in');
                        }
                    }
                } catch (error) {
                    console.error('Âä†ËΩΩËøõÂ∫¶Êï∞ÊçÆÊó∂Âá∫Èîô:', error);
                }
            }
        }

        function setupEventListeners() {
            document.querySelectorAll('.day-card').forEach(card => {
                card.addEventListener('click', () => {
                    const language = card.dataset.language;
                    showLanguage(language);
                });
            });
            
            document.getElementById('searchInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    searchWords();
                }
            });
            
            document.getElementById('pageInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') {
                    goToPage();
                }
            });
            
            document.addEventListener('keydown', (e) => {
                if (e.ctrlKey || e.metaKey) {
                    switch(e.key) {
                        case 'ArrowLeft':
                            e.preventDefault();
                            previousPage();
                            break;
                        case 'ArrowRight':
                            e.preventDefault();
                            nextPage();
                            break;
                        case 'f':
                            e.preventDefault();
                            document.getElementById('searchInput').focus();
                            break;
                    }
                }
            });
        }

        // È°µÈù¢Âä†ËΩΩÂÆåÊàêÂêéÂàùÂßãÂåñ
        document.addEventListener('DOMContentLoaded', init);
        
        if ('speechSynthesis' in window) {
            speechSynthesis.addEventListener('voiceschanged', () => {
                console.log('ËØ≠Èü≥Â∫ìÂ∑≤Âä†ËΩΩ');
            });
        }
    </script>
</body>
</html>